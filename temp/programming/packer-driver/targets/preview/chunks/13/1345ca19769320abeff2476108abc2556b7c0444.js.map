{"version":3,"sources":["file:///D:/CocosCreator/BuildLevel/assets/scripts/MainTheme.ts"],"names":["Num2Char","num","String","fromCharCode","Color2Char","color","a","b","c","GenerateLocate","i","x","y","InArray","key","arr","length","_decorator","Component","Node","Sprite","Label","director","sys","Light","LS_array","Flower","flower_array","LightPiece","LightTravel","FanseType","NewFanseArray","FanseDetect","FanseDraw","ClearMatrix","matrix1","matrix2","MirrorState","mirror_array","ChangeMirror","Mirror","StableMirror","Obstacle","ccclass","property","success","FS_locate","MainTheme","str","onLoad","pop","j","dir","node","layer","addComponent","LP","SetProps","addChild","discribe","getChildByName","label","getComponent","string","GenerateCode","node_list","children","node_num","L","F","M","G","S","mirror_list","Array","light","flower","mirror","st_mirror","obstacle","squarex","squarey","red","green","blue","id","level_str","console","log","start","scene_name","getScene","name","localStorage","getItem","MS_array","mirror_state","push","setItem","JSON","stringify","parse","SetMirror","L_array","FS_array","Collect","ChangeState","Success","GetSceneIndex","scene_index","slice","index","Number","SetUserState","scenen_index","LevelState","Reset","area","locate","Hint","event","hint_str","hint_num","other_num","hint_index","k","state","success_str"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, Sprite, Label, director, sys } from 'cc';\nimport { Light, LS_array } from './Light';\nimport { Flower, flower_array } from './Flower';\nimport { LightPiece } from './LightPiece';\nimport { LightSource, LightTravel, FanseType, NewFanseArray, FanseDetect, FanseDraw } from './LightTravel';\nimport { ClearMatrix, matrix1, matrix2 } from './Square';\nimport { MirrorState, mirror_array, ChangeMirror, Mirror } from './Mirror';\nimport { StableMirror } from './StableMirror';\nimport { Obstacle } from './Obstacle';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = MainTheme\n * DateTime = Thu Nov 04 2021 16:21:57 GMT+0800 (中國標準時間)\n * Author = XieYe0920\n * FileBasename = MainTheme.ts\n * FileBasenameNoExtension = MainTheme\n * URL = db://assets/scripts/MainTheme.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/zh/\n *\n */\n\nexport let success = false;\nexport let FS_locate:number[] = [-1, -1];\n\nfunction Num2Char(num: number): string {\n    if(num < 10) return String(num);\n    else return String.fromCharCode(num + 87);\n}\n\nfunction Color2Char(color: boolean[]): string {\n    let a = color[0] ? 1 : 0;\n    let b = color[1] ? 1 : 0;\n    let c = color[2] ? 1 : 0;\n    let num = a*4 + b*2 + c;\n    return String(num);\n}\n\nfunction GenerateLocate(i:number): number[] {\n    let x:number, y:number;\n    if(i < 12) {\n        x = i;\n        y = 1;\n    }\n    else {\n        x = i - 12;\n        y = 0;\n    }\n    return [x, y];\n}\n\nfunction InArray(key:number, arr:number[]) {\n    for(let i=0; i<arr.length; i++) {\n        if(arr[i] == key) return true;\n    }\n    return false;\n}\n\n@ccclass('MainTheme')\nexport class MainTheme extends Component {\n    str:string;\n    @property\n    public success_str:string = '';\n\n    onLoad() {\n        ClearMatrix();\n        while(LS_array.length > 0) LS_array.pop();\n        while(flower_array.length > 0) flower_array.pop();\n        while(mirror_array.length > 0) mirror_array.pop();\n        \n        let i:number, j:number, dir:number;\n        for(i=0; i<15; i++) {\n            for(j=0; j<15; j++){\n                for(dir=0; dir<8; dir++){\n                    let node = new Node('LP_node');\n                    node.layer = 33554432;\n                    node.addComponent(Sprite);\n                    let LP = node.addComponent(LightPiece);\n                    LP.SetProps([i, j], dir);\n                    this.node.addChild(node);\n                }\n            }\n        }\n\n        let discribe = this.node.getChildByName('LevelDescribe');\n        let label = discribe.getComponent(Label);\n        this.str = label.string;\n    }\n\n    GenerateCode() {\n        let node_list = this.node.children;\n        let node_num = node_list.length;\n        let L = 'L';\n        let F = 'F';\n        let M = 'M';\n        let G = '';\n        let S = '';\n        let mirror_list = new Array<number>(17);\n        for(let i=0; i<17; i++) mirror_list[i] = 0;\n\n        for(let i=6; i<node_num; i++) {\n            let node = node_list[i];\n            let light = node.getComponent(Light);\n            let flower = node.getComponent(Flower);\n            let mirror = node.getComponent(Mirror);\n            let st_mirror = node.getComponent(StableMirror);\n            let obstacle = node.getComponent(Obstacle);\n            if(light != null) {\n                L += Num2Char(light.squarex);\n                L += Num2Char(light.squarey);\n                L += Num2Char(light.dir);\n                L += Color2Char([light.red, light.green, light.blue]);\n            }\n            if(flower != null) {\n                F += Num2Char(flower.squarex);\n                F += Num2Char(flower.squarey);\n                F += Color2Char([flower.red, flower.green, flower.blue]);\n            }\n            if(mirror != null) {\n                mirror_list[mirror.id - 1]++;\n            }\n            if(st_mirror != null) {\n                let id = st_mirror.id;\n                switch(id) {\n                    case 7: {\n                        G += Num2Char(st_mirror.squarex);\n                        G += Num2Char(st_mirror.squarey);\n                        G += Num2Char(st_mirror.dir);\n                        break;\n                    }\n                    case 10: {\n                        S += Num2Char(st_mirror.squarex);\n                        S += Num2Char(st_mirror.squarey);\n                        S += '2';\n                        break;\n                    }\n                    case 13: {\n                        S += Num2Char(st_mirror.squarex);\n                        S += Num2Char(st_mirror.squarey);\n                        S += '3';\n                        break;\n                    }\n                    case 14: {\n                        S += Num2Char(st_mirror.squarex);\n                        S += Num2Char(st_mirror.squarey);\n                        S += '4';\n                        break;\n                    }\n                    default: break;\n                }\n            }\n            if(obstacle != null) {\n                S += Num2Char(obstacle.squarex);\n                S += Num2Char(obstacle.squarey);\n                S += '1';\n            }\n        }\n\n        for(let i=0; i<17; i++) {\n            if(mirror_list[i] > 0) {\n                M += Num2Char(i + 1);\n                M += Num2Char(mirror_list[i]);\n            }\n        }\n\n        let level_str = L + F + M;\n        if(G.length > 0) level_str = level_str + 'G' + G;\n        if(S.length > 0) level_str = level_str + 'S' + S;\n        console.log(level_str);\n    }\n\n    start() {\n        this.GenerateCode();\n\n        let scene_name = director.getScene().name;\n        let str = sys.localStorage.getItem(scene_name);\n        let MS_array:MirrorState[];\n        if(str == '' || str == null) {\n            MS_array = new Array<MirrorState>();\n            for(let i=0; i<mirror_array.length; i++) {\n                let mirror_state = new MirrorState(0, 2, GenerateLocate(i));\n                MS_array.push(mirror_state);\n            }\n            sys.localStorage.setItem(scene_name, JSON.stringify(MS_array));\n        }\n        else {\n            MS_array = JSON.parse(str);\n            if(MS_array.length != mirror_array.length) {\n                while(MS_array.length>0) MS_array.pop();\n                for(let i=0; i<mirror_array.length; i++) {\n                    let mirror_state = new MirrorState(0, 2, GenerateLocate(i));\n                    MS_array.push(mirror_state);\n                }\n                sys.localStorage.setItem(scene_name, JSON.stringify(MS_array));\n            }\n        }\n\n        for(let i=0; i<mirror_array.length; i++) {\n            mirror_array[i].SetMirror(MS_array[i]);\n        }\n\n        let L_array:LightSource[] = new Array<LightSource>(LS_array.length);\n        for(let i=0; i<LS_array.length; i++) L_array[i] = LS_array[i];\n\n        let FS_array = NewFanseArray();\n        LightTravel(L_array, FS_array, FanseType.Collect);\n        if(FS_locate[0] >= 0) {\n            FanseDetect(FS_locate, FS_array);\n            FanseDraw(FS_locate, FS_array);\n        }\n        \n\n        let i:number;\n        for(i=0; i<flower_array.length; i++) {\n            let flower = flower_array[i].getComponent(Flower);\n            flower.ChangeState();\n        }\n\n        this.Success();\n    }\n\n    GetSceneIndex(): number {\n        let scene_name = director.getScene().name;\n        let scene_index = scene_name.slice(5, scene_name.length);\n        let index = Number(scene_index);\n        return(index - 1);\n    }\n\n    SetUserState(scenen_index:number, success:boolean) {\n        let LevelState = JSON.parse(sys.localStorage.getItem('LevelState'));\n        let node = this.node.getChildByName('UserState');\n        let label = node.getComponent(Label);\n\n        if(LevelState[scenen_index]) {\n            label.string = '已过关';\n        }\n        else {\n            if(success) {\n                LevelState[scenen_index] = true;\n                label.string = '已过关';\n                sys.localStorage.setItem('LevelState', JSON.stringify(LevelState));\n            }\n            else {\n                label.string = '未过关';\n            }\n        }\n    }\n\n    Reset() {\n        let scene_name = director.getScene().name;\n        let MS_array:MirrorState[] = JSON.parse(sys.localStorage.getItem(scene_name));\n        for(let i=0; i<MS_array.length; i++) {\n            MS_array[i].dir = 0;\n            MS_array[i].area = 2;\n            MS_array[i].locate = GenerateLocate(i);\n            if(mirror_array[i].area == 1) {\n                matrix1[mirror_array[i].squarex*15 + mirror_array[i].squarey].id = -1;\n            }\n            mirror_array[i].SetMirror(MS_array[i]);\n        }\n\n        for(let i=0; i<12*2; i++) {\n            let [x, y] = GenerateLocate(i);\n            if(i < MS_array.length) matrix2[x*2 + y] = true;\n            else matrix2[x*2 + y] = false;\n        }\n\n        ChangeMirror();\n        this.Success();\n        sys.localStorage.setItem(scene_name, JSON.stringify(MS_array));\n    }\n\n    Hint(event:Event, hint_str:string) {\n        if(hint_str == '' || hint_str == null) return;\n\n        let scene_name = director.getScene().name;\n        let MS_array:MirrorState[] = JSON.parse(sys.localStorage.getItem(scene_name));\n        let hint_num = hint_str.length / 7;\n        let other_num = MS_array.length - hint_num;\n        let hint_index = new Array<number>(hint_num);\n\n        for(let i=0; i<MS_array.length; i++) {\n            MS_array[i].dir = 0;\n            MS_array[i].area = 2;\n            MS_array[i].locate = GenerateLocate(i);\n            if(mirror_array[i].area == 1) {\n                matrix1[mirror_array[i].squarex*15 + mirror_array[i].squarey].id = -1;\n            }\n            mirror_array[i].SetMirror(MS_array[i]);\n        }\n\n        for(let i=0; i<hint_num; i++) {\n            let str = hint_str.slice(i*7, (i + 1)*7);\n            let index = +str.slice(0, 2);\n\n            if(MS_array[index].area == 1) {\n                let [x, y] = MS_array[index].locate;\n                matrix1[x*15 + y].id = -1;\n            }\n\n            MS_array[index].area = 1;\n            MS_array[index].dir = +str[2];\n            MS_array[index].locate[0] = +str.slice(3, 5);\n            MS_array[index].locate[1] = +str.slice(5, 7);\n            mirror_array[index].SetMirror(MS_array[index]);\n            hint_index[i] = index;\n        }\n\n        let k = 0;\n        for(let i=0; i<MS_array.length; i++) {\n            if(!InArray(i, hint_index)) {\n                if(MS_array[i].area == 1) {\n                    let [x, y] = MS_array[i].locate;\n                    matrix1[x*15 + y].id = -1;\n                }\n\n                MS_array[i].area = 2;\n                MS_array[i].dir = 0;\n                MS_array[i].locate = GenerateLocate(k++);\n                mirror_array[i].SetMirror(MS_array[i]);\n            }\n        }\n\n        for(let i=0; i<12*2; i++) {\n            let [x, y] = GenerateLocate(i);\n            if(i < other_num) matrix2[x*2 + y] = true;\n            else matrix2[x*2 + y] = false;\n        }\n\n        ChangeMirror();\n        this.Success();\n        sys.localStorage.setItem(scene_name, JSON.stringify(MS_array));\n    }\n\n    Success() {\n        let success:boolean = true;\n        let i:number;\n        for(i=0; i<flower_array.length; i++) {\n            let flower = flower_array[i].getComponent(Flower);\n            success &&= flower.state;\n        }\n\n        let discribe = this.node.getChildByName('LevelDescribe');\n        let label = discribe.getComponent(Label);\n        let scenen_index = this.GetSceneIndex();\n\n        if(success) {\n            label.string = this.success_str;\n            this.SetUserState(scenen_index, true);\n        }\n        else {\n            label.string = this.str;\n            this.SetUserState(scenen_index, false);\n        }\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/zh/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}