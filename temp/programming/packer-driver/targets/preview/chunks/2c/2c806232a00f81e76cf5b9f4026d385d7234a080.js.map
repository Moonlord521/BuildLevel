{"version":3,"sources":["file:///D:/CocosCreator/BuildLevel/assets/scripts/LightTravel.ts"],"names":["LightSource","FanseProp","GetDiffDir","dir1","dir2","diff","GetStep","dir","GetFanseIndex","NewFanseArray","FS_array","Array","i","QuantumNewLS","LS","LS_array","loc","locate","l_dir","color","id","m_dir","mirrordir","nLS","step","old_loc","push","new_loc","QuantumLightTravel","LS1","LS2","nLS1","nLS2","index1","index2","step1","step2","NewLS","FS_type","FanseType","Collect","single_color","loc1","loc2","Draw","index","FS_color","over","LightTravel","length","pop","Detect","r","g","b","FanseDetect","FanseDraw","FS_locate","matrix1","GetInColor","AddColor","AddQuantumColor","constructor"],"mappings":";;;yFAkBaA,W,EAYPC,S;;AAUC,WAASC,UAAT,CAAoBC,IAApB,EAAiCC,IAAjC,EAA8C;AACjD,QAAIC,IAAI,GAAGF,IAAI,GAAGC,IAAlB;AACA,WAAOC,IAAI,IAAI,CAAR,GAAYA,IAAZ,GAAoB,IAAIA,IAA/B;AACH;;AAED,WAASC,OAAT,CAAiBC,GAAjB,EAAsC;AAClCA,IAAAA,GAAG,GAAGA,GAAG,GAAG,CAAZ;;AACA,YAAOA,GAAP;AACI,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAC,CAAF,EAAK,CAAL,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAC,CAAF,EAAK,CAAL,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAD,EAAI,CAAC,CAAL,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAC,CAAD,EAAI,CAAC,CAAL,CAAP;AARZ;AAUH;;AAED,WAASC,aAAT,CAAuBH,IAAvB,EAA4C;AACxC,YAAOA,IAAP;AACI,WAAK,CAAL;AAAQ,eAAO,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAP;;AACR,WAAK,CAAL;AAAQ,eAAO,CAAP;;AACR;AAAS,eAAO,CAAP;AALb;AAOH;;AAEM,WAASI,aAAT,GAAqC;AACxC,QAAIC,QAAQ,GAAG,IAAIC,KAAJ,CAAqB,CAArB,CAAf;;AACA,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,CAAf,EAAkBA,CAAC,EAAnB,EAAuB;AACnBF,MAAAA,QAAQ,CAACE,CAAD,CAAR,GAAc,IAAIX,SAAJ,EAAd;AACH;;AACD,WAAOS,QAAP;AACH;;AAED,WAASG,YAAT,CAAsBC,EAAtB,EAAsCC,QAAtC,EAA8D;AAC1D,QAAIC,GAAG,GAAGF,EAAE,CAACG,MAAb;AACA,QAAIC,KAAK,GAAGJ,EAAE,CAACP,GAAf;AACA,QAAIY,KAAK,GAAGL,EAAE,CAACK,KAAf;AACA,QAAIC,EAAE,GAAG;AAAA;AAAA,4BAAQJ,GAAG,CAAC,CAAD,CAAH,GAAO,EAAP,GAAYA,GAAG,CAAC,CAAD,CAAvB,EAA4BI,EAArC;AACA,QAAIC,KAAK,GAAG;AAAA;AAAA,4BAAQL,GAAG,CAAC,CAAD,CAAH,GAAO,EAAP,GAAYA,GAAG,CAAC,CAAD,CAAvB,EAA4BM,SAAxC;AACA,QAAIjB,IAAI,GAAGH,UAAU,CAACmB,KAAD,EAAQH,KAAR,CAArB;;AACA,YAAOE,EAAP;AACI,WAAK,CAAC,CAAN;AACA,WAAK,CAAL;AAAQ;AACJ;AAAA;AAAA,kDAAgBJ,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;AACA,iBAAOL,EAAP;AACH;;AACD,WAAK,CAAL;AAAQ;AACJ;AAAA;AAAA,kDAAgBE,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIkB,GAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;AACA,uBAAOI,GAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,IAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,IAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,KAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AAbb;AAeH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIkB,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,KAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,KAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,KAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,uBAAOI,KAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AAjBb;AAmBH;;AACD,WAAK,CAAL,CA9CJ,CA8CY;;AACR,WAAK,EAAL,CA/CJ,CA+Ca;;AACT,WAAK,EAAL;AAAS;AAAE;AACP,cAAIC,IAAI,GAAGlB,OAAO,CAACY,KAAD,CAAlB;AACA,cAAIO,OAAO,GAAG,IAAId,KAAJ,CAAkB,CAAlB,CAAd;AACAc,UAAAA,OAAO,CAAC,CAAD,CAAP,GAAaT,GAAG,CAAC,CAAD,CAAH,GAASQ,IAAI,CAAC,CAAD,CAA1B;AACAC,UAAAA,OAAO,CAAC,CAAD,CAAP,GAAaT,GAAG,CAAC,CAAD,CAAH,GAASQ,IAAI,CAAC,CAAD,CAA1B;;AACA,cAAID,KAAG,GAAG,IAAIvB,WAAJ,CAAgByB,OAAhB,EAAyBP,KAAzB,EAAgCC,KAAhC,CAAV;;AACAJ,UAAAA,QAAQ,CAACW,IAAT,CAAcH,KAAd;AACA,iBAAO,IAAP;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,KAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AATb;AAWH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,KAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,KAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AATb;AAWH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AATb;AAWH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAIkB,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4BC,KAA5B,CAAV;;AACA,uBAAOI,MAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AANb;AAQH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK,IAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACd,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHI,MAIA;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK,IAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACd,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHI,MAIA;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAtC,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AA3Db;AA6DH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIkB,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,CAA5B,CAAV;;AACA,uBAAOI,MAAP;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,CAA5B,CAAV;;AACA,uBAAOI,MAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AATb;AAWH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,cAAIK,KAAI,GAAGlB,OAAO,CAACY,KAAD,CAAlB;;AACA,cAAIS,OAAO,GAAG,IAAIhB,KAAJ,CAAkB,CAAlB,CAAd;AACA,WAACgB,OAAO,CAAC,CAAD,CAAR,EAAaA,OAAO,CAAC,CAAD,CAApB,IAA2BX,GAA3B;;AAEA,iBAAM,IAAN,EAAY;AACRW,YAAAA,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAAP,GAAaH,KAAI,CAAC,CAAD,CAA9B;AACAG,YAAAA,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAAP,GAAaH,KAAI,CAAC,CAAD,CAA9B;AAEA,gBAAIG,OAAO,CAAC,CAAD,CAAP,GAAa,CAAd,IAAqBA,OAAO,CAAC,CAAD,CAAP,IAAc,EAAtC,EAA2C,OAAO,IAAP;AAC3C,gBAAIA,OAAO,CAAC,CAAD,CAAP,GAAa,CAAd,IAAqBA,OAAO,CAAC,CAAD,CAAP,IAAc,EAAtC,EAA2C,OAAO,IAAP;;AAE3C,gBAAG;AAAA;AAAA,oCAAQA,OAAO,CAAC,CAAD,CAAP,GAAW,EAAX,GAAgBA,OAAO,CAAC,CAAD,CAA/B,EAAoCP,EAApC,IAA0C,EAA7C,EAAiD;AAC7C,kBAAIG,MAAG,GAAG,IAAIvB,WAAJ,CAAgB2B,OAAhB,EAAyBT,KAAzB,EAAgCC,KAAhC,CAAV;;AACA,qBAAOI,MAAP;AACH;AACJ;AACJ;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,cAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,iBAAOI,MAAP;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,cAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,CAAV;;AACA,iBAAOI,MAAP;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD;AAAS,qBAAO,IAAP;AAlCb;AAoCH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD;AAAS,qBAAO,IAAP;AAlCb;AAoCH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH,iBAHD,MAIK;AACD,sBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAtC,CAAV;;AACA,yBAAOI,MAAP;AACH;AACJ;;AACD;AAAS,qBAAO,IAAP;AAlCb;AAoCH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;;AACA,kBAAOd,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4BC,KAA5B,CAAV;;AACA,uBAAOI,MAAP;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGJ,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAII,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA5B,CAAV;;AACA,yBAAOK,MAAP;AACH;;AACD,uBAAO,IAAP;AACH;;AACD;AAAS,qBAAO,IAAP;AA9Bb;AAgCH;;AACD,WAAK,GAAL;AAAU;AAAE;AACR;AAAA;AAAA,kDAAgBP,GAAhB,EAAqB,CAACE,KAAK,GAAG,CAAT,IAAc,CAAnC,EAAsCC,KAAtC,EAA6C,IAA7C;AACA,iBAAO,IAAP;AACH;;AACD;AAAS,eAAO,IAAP;AArXb;AAuXH;;AAED,WAASS,kBAAT,CAA4BC,GAA5B,EAA6CC,GAA7C,EAA8Df,QAA9D,EAAsF;AAClF,QAAGc,GAAG,IAAI,IAAP,IAAeC,GAAG,IAAI,IAAzB,EAA+B;;AAC/B,QAAGD,GAAG,IAAI,IAAV,EAAgB;AACZ,UAAIL,IAAI,GAAGlB,OAAO,CAACwB,GAAG,CAACvB,GAAL,CAAlB;AACA,UAAIS,GAAG,GAAG,IAAIL,KAAJ,CAAkB,CAAlB,CAAV;AACAK,MAAAA,GAAG,CAAC,CAAD,CAAH,GAASc,GAAG,CAACb,MAAJ,CAAW,CAAX,IAAgBO,IAAI,CAAC,CAAD,CAA7B;AACAR,MAAAA,GAAG,CAAC,CAAD,CAAH,GAASc,GAAG,CAACb,MAAJ,CAAW,CAAX,IAAgBO,IAAI,CAAC,CAAD,CAA7B;AACA,UAAID,GAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,GAAhB,EAAqBc,GAAG,CAACvB,GAAzB,EAA8BuB,GAAG,CAACX,KAAlC,CAAV;AACAJ,MAAAA,QAAQ,CAACW,IAAT,CAAcH,GAAd;AACA;AACH;;AACD,QAAGO,GAAG,IAAI,IAAV,EAAgB;AACZ,UAAIN,MAAI,GAAGlB,OAAO,CAACuB,GAAG,CAACtB,GAAL,CAAlB;;AACA,UAAIS,IAAG,GAAG,IAAIL,KAAJ,CAAkB,CAAlB,CAAV;;AACAK,MAAAA,IAAG,CAAC,CAAD,CAAH,GAASa,GAAG,CAACZ,MAAJ,CAAW,CAAX,IAAgBO,MAAI,CAAC,CAAD,CAA7B;AACAR,MAAAA,IAAG,CAAC,CAAD,CAAH,GAASa,GAAG,CAACZ,MAAJ,CAAW,CAAX,IAAgBO,MAAI,CAAC,CAAD,CAA7B;;AACA,UAAID,MAAG,GAAG,IAAIvB,WAAJ,CAAgBgB,IAAhB,EAAqBa,GAAG,CAACtB,GAAzB,EAA8BsB,GAAG,CAACV,KAAlC,CAAV;;AACAJ,MAAAA,QAAQ,CAACW,IAAT,CAAcH,MAAd;AACA;AACH;;AACD,QAAIQ,IAAI,GAAGlB,YAAY,CAACgB,GAAD,EAAMd,QAAN,CAAvB;AACA,QAAIiB,IAAI,GAAGnB,YAAY,CAACiB,GAAD,EAAMf,QAAN,CAAvB;;AAEA,QAAGgB,IAAH,EAAS;AACL,UAAIE,MAAM,GAAGF,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAe,EAAf,GAAoBc,IAAI,CAACd,MAAL,CAAY,CAAZ,CAAjC;;AACA,UAAGe,IAAI,IAAI;AAAA;AAAA,8BAAQC,MAAR,EAAgBb,EAAhB,IAAsB,CAAjC,EAAoC;AAChC,YAAIf,IAAI,GAAGH,UAAU,CAAC;AAAA;AAAA,gCAAQ+B,MAAR,EAAgBX,SAAjB,EAA4BS,IAAI,CAACxB,GAAjC,CAArB;;AACA,YAAGF,IAAI,IAAI,CAAX,EAAc;AACV2B,UAAAA,IAAI,CAACb,KAAL,GAAa,CAACa,IAAI,CAACb,KAAL,CAAW,CAAX,CAAD,EAAgBa,IAAI,CAACb,KAAL,CAAW,CAAX,CAAhB,EAA+Ba,IAAI,CAACb,KAAL,CAAW,CAAX,CAA/B,CAAb;AACH,SAFD,MAGK;AACDa,UAAAA,IAAI,CAACb,KAAL,GAAa,CAACa,IAAI,CAACb,KAAL,CAAW,CAAX,CAAD,EAAgBa,IAAI,CAACb,KAAL,CAAW,CAAX,CAAhB,EAA+Ba,IAAI,CAACb,KAAL,CAAW,CAAX,CAA/B,CAAb;AACH;AACJ;AACJ;;AACD,QAAGa,IAAH,EAAS;AACL,UAAIE,MAAM,GAAGF,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAe,EAAf,GAAoBe,IAAI,CAACf,MAAL,CAAY,CAAZ,CAAjC;;AACA,UAAGc,IAAI,IAAI;AAAA;AAAA,8BAAQG,MAAR,EAAgBd,EAAhB,IAAsB,CAAjC,EAAoC;AAChC,YAAIf,KAAI,GAAGH,UAAU,CAAC;AAAA;AAAA,gCAAQgC,MAAR,EAAgBZ,SAAjB,EAA4BU,IAAI,CAACzB,GAAjC,CAArB;;AACA,YAAGF,KAAI,IAAI,CAAX,EAAc;AACV0B,UAAAA,IAAI,CAACZ,KAAL,GAAa,CAACY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAAD,EAAgBY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAAhB,EAA+BY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAA/B,CAAb;AACH,SAFD,MAGK;AACDY,UAAAA,IAAI,CAACZ,KAAL,GAAa,CAACY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAAD,EAAgBY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAAhB,EAA+BY,IAAI,CAACZ,KAAL,CAAW,CAAX,CAA/B,CAAb;AACH;AACJ;AACJ;;AACD,QAAGY,IAAH,EAAS;AACL;AAAA;AAAA,8CAAgBA,IAAI,CAACd,MAArB,EAA6Bc,IAAI,CAACxB,GAAlC,EAAuCwB,IAAI,CAACZ,KAA5C,EAAmD,KAAnD;AACA,UAAIgB,KAAK,GAAG7B,OAAO,CAACyB,IAAI,CAACxB,GAAN,CAAnB;AACAwB,MAAAA,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAiBc,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAiBkB,KAAK,CAAC,CAAD,CAAvC;AACAJ,MAAAA,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAiBc,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAiBkB,KAAK,CAAC,CAAD,CAAvC;AACA,UAAGJ,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAe,CAAf,IAAoBc,IAAI,CAACd,MAAL,CAAY,CAAZ,KAAgB,EAApC,IAA0Cc,IAAI,CAACd,MAAL,CAAY,CAAZ,IAAe,CAAzD,IAA8Dc,IAAI,CAACd,MAAL,CAAY,CAAZ,KAAgB,EAAjF,EAAqFc,IAAI,GAAG,IAAP;AACxF;;AACD,QAAGC,IAAH,EAAS;AACL;AAAA;AAAA,8CAAgBA,IAAI,CAACf,MAArB,EAA6Be,IAAI,CAACzB,GAAlC,EAAuCyB,IAAI,CAACb,KAA5C,EAAmD,KAAnD;AACA,UAAIiB,KAAK,GAAG9B,OAAO,CAAC0B,IAAI,CAACzB,GAAN,CAAnB;AACAyB,MAAAA,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAiBe,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAiBmB,KAAK,CAAC,CAAD,CAAvC;AACAJ,MAAAA,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAiBe,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAiBmB,KAAK,CAAC,CAAD,CAAvC;AACA,UAAGJ,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAe,CAAf,IAAoBe,IAAI,CAACf,MAAL,CAAY,CAAZ,KAAgB,EAApC,IAA0Ce,IAAI,CAACf,MAAL,CAAY,CAAZ,IAAe,CAAzD,IAA8De,IAAI,CAACf,MAAL,CAAY,CAAZ,KAAgB,EAAjF,EAAqFe,IAAI,GAAG,IAAP;AACxF;;AACDJ,IAAAA,kBAAkB,CAACG,IAAD,EAAOC,IAAP,EAAajB,QAAb,CAAlB;AACH;;AAEM,WAASsB,KAAT,CAAejB,EAAf,EAA0BH,MAA1B,EAA2CI,KAA3C,EAAyDH,KAAzD,EAAuEC,KAAvE,EAAwFJ,QAAxF,EAAgHL,QAAhH,EAAsI4B,OAAtI,EAA6K;AAAA,QAAvCA,OAAuC;AAAvCA,MAAAA,OAAuC,GAAnBC,SAAS,CAACC,OAAS;AAAA;;AAChL,QAAInC,IAAI,GAAGH,UAAU,CAACmB,KAAD,EAAQH,KAAR,CAArB,CADgL,CAC3I;;AACrC,YAAOE,EAAP;AACI,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOf,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIS,EAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,EAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,GAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,GAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,IAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,IAAd;AACA;AACH;;AACD;AAAS;AAhBb;;AAkBA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIS,IAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,IAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,IAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,IAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,IAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,IAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,IAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,IAAd;AACA;AACH;;AACD;AAAS;AArBb;;AAuBA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAIwB,GAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B,CAAV;AACA,oBAAIW,GAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAV;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcG,GAAd,EAAmBC,GAAnB;AACA;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAID,IAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B,CAAV;;AACA,oBAAIW,IAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAV;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcG,IAAd,EAAmBC,IAAnB;AACA;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAID,IAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B,CAAV;;AACA,oBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAV;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcG,IAAd,EAAmBC,KAAnB;AACA;AACH;;AACD;AAAS;AAtBb;;AAwBA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOzB,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AATb;;AAWA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AATb;;AAWA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AATb;;AAWA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAIS,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD;AAAS;AAPb;;AASA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAAzC,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AA7Db;;AA+DA;AACH;;AACD,WAAK,CAAL;AAAQ;AAAE;AACN,kBAAOT,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,oBAAIS,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,CAA/B,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqBA,KAAK,CAAC,CAAD,CAA1B,CAA/B,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD;AAAS;AAXb;;AAaA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,cAAIU,IAAI,GAAGlB,OAAO,CAACY,KAAD,CAAlB;AACA,cAAIF,GAAG,GAAG,IAAIL,KAAJ,CAAkB,CAAlB,CAAV;AACA,WAACK,GAAG,CAAC,CAAD,CAAJ,EAASA,GAAG,CAAC,CAAD,CAAZ,IAAmBC,MAAnB;;AAEA,iBAAM,IAAN,EAAY;AACRD,YAAAA,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAH,GAASQ,IAAI,CAAC,CAAD,CAAtB;AACAR,YAAAA,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAH,GAASQ,IAAI,CAAC,CAAD,CAAtB;AAEA,gBAAIR,GAAG,CAAC,CAAD,CAAH,GAAS,CAAV,IAAiBA,GAAG,CAAC,CAAD,CAAH,IAAU,EAA9B,EAAmC;AACnC,gBAAIA,GAAG,CAAC,CAAD,CAAH,GAAS,CAAV,IAAiBA,GAAG,CAAC,CAAD,CAAH,IAAU,EAA9B,EAAmC;;AAEnC,gBAAG;AAAA;AAAA,oCAAQA,GAAG,CAAC,CAAD,CAAH,GAAO,EAAP,GAAYA,GAAG,CAAC,CAAD,CAAvB,EAA4BI,EAA5B,IAAkC,EAArC,EAAyC;AACrC,kBAAIN,KAAE,GAAG,IAAId,WAAJ,CAAgBgB,GAAhB,EAAqBE,KAArB,EAA4BC,KAA5B,CAAT;;AACAJ,cAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;AACJ;;AACD;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,kBAAOT,IAAP;AACI,iBAAK,CAAL;AAAQ;AACJ,qBAAI,IAAIO,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,CAAf,EAAkBA,CAAC,EAAnB,EAAuB;AACnB,sBAAGO,KAAK,CAACP,CAAD,CAAR,EAAa;AACT,wBAAI6B,YAAY,GAAG,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,CAAnB;AACAA,oBAAAA,YAAY,CAAC7B,CAAD,CAAZ,GAAkB,IAAlB;AACA;AAAA;AAAA,4DAAgBK,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCuB,YAAzC,EAAuD,KAAvD;AACA;AAAA;AAAA,4DAAgBxB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCuB,YAAzC,EAAuD,KAAvD;AACA,wBAAIN,KAAK,GAAG7B,OAAO,CAAC,CAACY,KAAK,GAAG,CAAT,IAAc,CAAf,CAAnB;AACA,wBAAIkB,KAAK,GAAG9B,OAAO,CAAC,CAACY,KAAK,GAAG,CAAT,IAAc,CAAf,CAAnB;AACA,wBAAIwB,IAAI,GAAG,IAAI/B,KAAJ,CAAkB,CAAlB,CAAX;AACA,wBAAIgC,IAAI,GAAG,IAAIhC,KAAJ,CAAkB,CAAlB,CAAX;AACA+B,oBAAAA,IAAI,CAAC,CAAD,CAAJ,GAAUzB,MAAM,CAAC,CAAD,CAAN,GAAYkB,KAAK,CAAC,CAAD,CAA3B;AACAO,oBAAAA,IAAI,CAAC,CAAD,CAAJ,GAAUzB,MAAM,CAAC,CAAD,CAAN,GAAYkB,KAAK,CAAC,CAAD,CAA3B;AACAQ,oBAAAA,IAAI,CAAC,CAAD,CAAJ,GAAU1B,MAAM,CAAC,CAAD,CAAN,GAAYmB,KAAK,CAAC,CAAD,CAA3B;AACAO,oBAAAA,IAAI,CAAC,CAAD,CAAJ,GAAU1B,MAAM,CAAC,CAAD,CAAN,GAAYmB,KAAK,CAAC,CAAD,CAA3B;;AACA,wBAAIP,KAAG,GAAG,IAAI7B,WAAJ,CAAgB0C,IAAhB,EAAsB,CAACxB,KAAK,GAAG,CAAT,IAAc,CAApC,EAAuCuB,YAAvC,CAAV;;AACA,wBAAIX,KAAG,GAAG,IAAI9B,WAAJ,CAAgB2C,IAAhB,EAAsB,CAACzB,KAAK,GAAG,CAAT,IAAc,CAApC,EAAuCuB,YAAvC,CAAV;;AACA,wBAAGC,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAAR,IAAaA,IAAI,CAAC,CAAD,CAAJ,IAAS,EAAtB,IAA4BA,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAApC,IAAyCA,IAAI,CAAC,CAAD,CAAJ,IAAS,EAArD,EAAyDb,KAAG,GAAG,IAAN;AACzD,wBAAGc,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAAR,IAAaA,IAAI,CAAC,CAAD,CAAJ,IAAS,EAAtB,IAA4BA,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAApC,IAAyCA,IAAI,CAAC,CAAD,CAAJ,IAAS,EAArD,EAAyDb,KAAG,GAAG,IAAN;AACzDF,oBAAAA,kBAAkB,CAACC,KAAD,EAAMC,KAAN,EAAWf,QAAX,CAAlB;AACH;AACJ;;AACD;AACH;;AACD;AAAS;AAzBb;;AA2BA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP;AAAA;AAAA,sCAAU,CAAV,IAAeE,MAAM,CAAC,CAAD,CAArB;AACA;AAAA;AAAA,sCAAU,CAAV,IAAeA,MAAM,CAAC,CAAD,CAArB;;AACA,kBAAOZ,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AACA,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGiC,OAAO,IAAIC,SAAS,CAACK,IAAxB,EAA8B;AAC1B,sBAAIC,KAAK,GAAGrC,aAAa,CAACH,IAAD,CAAzB;AACA,sBAAIyC,QAAQ,GAAGpC,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAA/B;;AACA,sBAAIA,KAAK,CAAC,CAAD,CAAL,IAAY2B,QAAQ,CAAC,CAAD,CAArB,IAA8B3B,KAAK,CAAC,CAAD,CAAL,IAAY2B,QAAQ,CAAC,CAAD,CAAlD,IAA2D3B,KAAK,CAAC,CAAD,CAAL,IAAY2B,QAAQ,CAAC,CAAD,CAAlF,EAAwF;AAAA;;AACpF,6CAAApC,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,MAAsB,CAAtB,iCAA6B,CAACA,KAAK,CAAC,CAAD,CAAnC;AACA,8CAAAT,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,OAAsB,CAAtB,mCAA6B,CAACA,KAAK,CAAC,CAAD,CAAnC;AACA,8CAAAT,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,OAAsB,CAAtB,mCAA6B,CAACA,KAAK,CAAC,CAAD,CAAnC;AACAT,oBAAAA,QAAQ,CAACmC,KAAD,CAAR,CAAgBE,IAAhB,GAAuB,KAAvB;AACH;;AACD,sBAAG,CAACrC,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,CAAsB,CAAtB,CAAD,IAA6B,CAACT,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,CAAsB,CAAtB,CAA9B,IAA0D,CAACT,QAAQ,CAACmC,KAAD,CAAR,CAAgB1B,KAAhB,CAAsB,CAAtB,CAA9D,EAAwF;AACpFT,oBAAAA,QAAQ,CAACmC,KAAD,CAAR,CAAgBE,IAAhB,GAAuB,IAAvB;AACH;AACJ;;AACD;AACH;;AACD;AAAS;AApBb;;AAsBA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,cAAIjC,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,UAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,cAAIA,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyCC,KAAzC,CAAT;;AACAJ,UAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,kBAAOT,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAAC,KAAD,EAAQC,KAAK,CAAC,CAAD,CAAb,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AArCb;;AAuCA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,kBAAOzB,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAW,KAAX,EAAkBA,KAAK,CAAC,CAAD,CAAvB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AArCb;;AAuCA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,kBAAOzB,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGX,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIU,KAAG,GAAG,IAAI7B,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA/B,CAAV;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcG,KAAd;AACH;;AACD,oBAAGV,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAApB,EAAyB;AACrB,sBAAIW,KAAG,GAAG,IAAI9B,WAAJ,CAAgBiB,MAAhB,EAAwB,CAACC,KAAK,GAAG,CAAT,IAAc,CAAtC,EAAyC,CAACC,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,EAAqB,KAArB,CAAzC,CAAV;;AACAJ,kBAAAA,QAAQ,CAACW,IAAT,CAAcI,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AArCb;;AAuCA;AACH;;AACD,WAAK,EAAL;AAAS;AAAE;AACP,kBAAOzB,IAAP;AACI,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGc,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAIA,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+BC,KAA/B,CAAT;;AACAJ,gBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACA;AACH;;AACD,iBAAK,CAAL;AACA,iBAAK,CAAL;AAAQ;AACJ,oBAAGK,KAAK,CAAC,CAAD,CAAR,EAAa;AACT,sBAAIL,KAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBC,KAAxB,EAA+B,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAA/B,CAAT;;AACAH,kBAAAA,QAAQ,CAACW,IAAT,CAAcZ,KAAd;AACH;;AACD;AACH;;AACD;AAAS;AA/Bb;;AAiCA;AACH;;AACD;AAAS;AA5cb;AA8cH;;AAEM,WAASkC,WAAT,CAAqBjC,QAArB,EAA6CL,QAA7C,EAAmE4B,OAAnE,EAA0G;AAAA,QAAvCA,OAAuC;AAAvCA,MAAAA,OAAuC,GAAnBC,SAAS,CAACC,OAAS;AAAA;;AAC7G,WAAMzB,QAAQ,CAACkC,MAAT,GAAkB,CAAxB,EAA2B;AACvB,UAAInC,EAAE,GAAGC,QAAQ,CAACmC,GAAT,EAAT;AACA,UAAGZ,OAAO,IAAIC,SAAS,CAACY,MAAxB,EAAgC;AAAA;AAAA,gCAASrC,EAAE,CAACG,MAAZ,EAAoBH,EAAE,CAACP,GAAvB,EAA4BO,EAAE,CAACK,KAA/B,EAAsC,KAAtC;AAEhC,UAAIC,EAAS,GAAG,CAAC,CAAjB;AACA,UAAII,IAAI,GAAGlB,OAAO,CAACQ,EAAE,CAACP,GAAJ,CAAlB;AACA,UAAIU,MAAe,GAAG,IAAIN,KAAJ,CAAkB,CAAlB,CAAtB;AACA,OAACM,MAAM,CAAC,CAAD,CAAP,EAAYA,MAAM,CAAC,CAAD,CAAlB,IAAyBH,EAAE,CAACG,MAA5B;;AAEA,aAAM,IAAN,EAAY;AACRA,QAAAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAN,GAAYO,IAAI,CAAC,CAAD,CAA5B;AACAP,QAAAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAN,GAAYO,IAAI,CAAC,CAAD,CAA5B;AAEA,YAAIP,MAAM,CAAC,CAAD,CAAN,GAAY,CAAb,IAAoBA,MAAM,CAAC,CAAD,CAAN,IAAa,EAApC,EAAyC;AACzC,YAAIA,MAAM,CAAC,CAAD,CAAN,GAAY,CAAb,IAAoBA,MAAM,CAAC,CAAD,CAAN,IAAa,EAApC,EAAyC;AAEzC,YAAI,CAACmC,CAAD,EAAIC,CAAJ,EAAOC,CAAP,IAAY;AAAA;AAAA,sCAAWrC,MAAX,EAAmB,CAACH,EAAE,CAACP,GAAH,GAAS,CAAV,IAAe,CAAlC,CAAhB;AACA,YAAG,CAAC,CAACO,EAAE,CAACK,KAAH,CAAS,CAAT,CAAD,IAAgBiC,CAAjB,MAAwB,CAACtC,EAAE,CAACK,KAAH,CAAS,CAAT,CAAD,IAAgBkC,CAAxC,MAA+C,CAACvC,EAAE,CAACK,KAAH,CAAS,CAAT,CAAD,IAAgBmC,CAA/D,CAAH,EAAsE;;AAEtE,YAAG;AAAA;AAAA,gCAAQrC,MAAM,CAAC,CAAD,CAAN,GAAU,EAAV,GAAeA,MAAM,CAAC,CAAD,CAA7B,EAAkCG,EAAlC,GAAuC,CAA1C,EAA6C;AACzCA,UAAAA,EAAE,GAAG;AAAA;AAAA,kCAAQH,MAAM,CAAC,CAAD,CAAN,GAAU,EAAV,GAAeA,MAAM,CAAC,CAAD,CAA7B,EAAkCG,EAAvC;AACA;AACH;;AAED,YAAGkB,OAAO,IAAIC,SAAS,CAACY,MAAxB,EAAgC;AAAA;AAAA,kCAASlC,MAAT,EAAiB,CAACH,EAAE,CAACP,GAAH,GAAS,CAAV,IAAe,CAAhC,EAAmCO,EAAE,CAACK,KAAtC,EAA6C,IAA7C;AAChC,YAAGmB,OAAO,IAAIC,SAAS,CAACY,MAAxB,EAAgC;AAAA;AAAA,kCAASlC,MAAT,EAAiBH,EAAE,CAACP,GAApB,EAAyBO,EAAE,CAACK,KAA5B,EAAmC,KAAnC;AACnC;;AAED,UAAGC,EAAE,GAAG,CAAL,IAAUA,EAAE,IAAI,GAAnB,EAAwB;AACpB,YAAGkB,OAAO,IAAIC,SAAS,CAACY,MAAxB,EAAgC;AAAA;AAAA,kCAASlC,MAAT,EAAiB,CAACH,EAAE,CAACP,GAAH,GAAS,CAAV,IAAe,CAAhC,EAAmCO,EAAE,CAACK,KAAtC,EAA6C,IAA7C;AAChC,YAAIE,KAAK,GAAG;AAAA;AAAA,gCAAQJ,MAAM,CAAC,CAAD,CAAN,GAAU,EAAV,GAAeA,MAAM,CAAC,CAAD,CAA7B,EAAkCK,SAA9C;AACAe,QAAAA,KAAK,CAACjB,EAAD,EAAKH,MAAL,EAAaI,KAAb,EAAoBP,EAAE,CAACP,GAAvB,EAA4BO,EAAE,CAACK,KAA/B,EAAsCJ,QAAtC,EAAgDL,QAAhD,CAAL;AACH;AACJ;AACJ;;AAEM,WAAS6C,WAAT,CAAqBtC,MAArB,EAAsCP,QAAtC,EAA4D;AAC/D,WAAM,CAACA,QAAQ,CAAC,CAAD,CAAR,CAAYqC,IAAb,IAAqB,CAACrC,QAAQ,CAAC,CAAD,CAAR,CAAYqC,IAAlC,IAA0C,CAACrC,QAAQ,CAAC,CAAD,CAAR,CAAYqC,IAAvD,IAA+D,CAACrC,QAAQ,CAAC,CAAD,CAAR,CAAYqC,IAAlF,EAAwF;AACpF,UAAIhC,QAAQ,GAAG,IAAIJ,KAAJ,EAAf;;AACA,WAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,CAAf,EAAkBA,CAAC,EAAnB,EAAuB;AACnB,YAAG,CAACF,QAAQ,CAACE,CAAD,CAAR,CAAYmC,IAAhB,EAAsB;AAClBrC,UAAAA,QAAQ,CAACE,CAAD,CAAR,CAAYmC,IAAZ,GAAmB,IAAnB;AACA,cAAIxC,GAAG,GAAG,CAAC;AAAA;AAAA,kCAAQU,MAAM,CAAC,CAAD,CAAN,GAAU,EAAV,GAAeA,MAAM,CAAC,CAAD,CAA7B,EAAkCK,SAAlC,GAA8C,IAAEV,CAAjD,IAAsD,CAAhE;AACA,cAAIE,EAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBV,GAAxB,EAA6BG,QAAQ,CAACE,CAAD,CAAR,CAAYO,KAAzC,CAAT;AACAJ,UAAAA,QAAQ,CAACW,IAAT,CAAcZ,EAAd;AACH;AACJ;;AACDkC,MAAAA,WAAW,CAACjC,QAAD,EAAWL,QAAX,EAAqB6B,SAAS,CAACY,MAA/B,CAAX;AACH;AACJ;;AAEM,WAASK,SAAT,CAAmBvC,MAAnB,EAAoCP,QAApC,EAA0D;AAC7D,QAAIK,QAAQ,GAAG,IAAIJ,KAAJ,EAAf;;AACA,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,CAAf,EAAkBA,CAAC,EAAnB,EAAuB;AACnB,UAAIO,KAAK,GAAGT,QAAQ,CAACE,CAAD,CAAR,CAAYO,KAAxB;;AACA,UAAG,EAAGA,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwBA,KAAK,CAAC,CAAD,CAA9B,IAAuC,CAACA,KAAK,CAAC,CAAD,CAAN,IAAa,CAACA,KAAK,CAAC,CAAD,CAAnB,IAA0B,CAACA,KAAK,CAAC,CAAD,CAAzE,CAAH,EAAmF;AAC/E,YAAIZ,GAAG,GAAG,CAAC;AAAA;AAAA,gCAAQU,MAAM,CAAC,CAAD,CAAN,GAAU,EAAV,GAAeA,MAAM,CAAC,CAAD,CAA7B,EAAkCK,SAAlC,GAA8C,IAAEV,CAAjD,IAAsD,CAAhE;AACA,YAAIE,EAAE,GAAG,IAAId,WAAJ,CAAgBiB,MAAhB,EAAwBV,GAAxB,EAA6BG,QAAQ,CAACE,CAAD,CAAR,CAAYO,KAAzC,CAAT;AACAJ,QAAAA,QAAQ,CAACW,IAAT,CAAcZ,EAAd;AACH;AACJ;;AACDkC,IAAAA,WAAW,CAACjC,QAAD,EAAWL,QAAX,EAAqB6B,SAAS,CAACK,IAA/B,CAAX;AACH;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;gBAjgCgB1C,U;mBA6BAO,a;WAwcA4B,K;iBAkdAW,W;iBAqCAO,W;eAeAC;;;;;;;;;AAlhCPC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,O,iBAAAA,O;AAASC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,e,iBAAAA,e;;;;;;;AAExC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;2BAEYtB,S,0BAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;eAAAA,S;;;6BAECvC,W,GAAN,MAAMA,WAAN,CAAkB;AAKrB8D,QAAAA,WAAW,CAAC7C,MAAD,EAAmBV,GAAnB,EAAgCY,KAAhC,EAAgD;AAAA,eAJ3DF,MAI2D;AAAA,eAH3DV,GAG2D;AAAA,eAF3DY,KAE2D;AACvD,eAAKF,MAAL,GAAcA,MAAd;AACA,eAAKV,GAAL,GAAWA,GAAX;AACA,eAAKY,KAAL,GAAaA,KAAb;AACH;;AAToB,O;;AAYnBlB,MAAAA,S,GAAN,MAAMA,SAAN,CAAgB;AAIZ6D,QAAAA,WAAW,GAAG;AAAA,eAHdf,IAGc;AAAA,eAFd5B,KAEc;AACV,eAAK4B,IAAL,GAAY,IAAZ;AACA,eAAK5B,KAAL,GAAa,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAAb;AACH;;AAPW,O","sourcesContent":["\nimport { FS_locate } from \"./MainTheme\";\nimport { matrix1, GetInColor, AddColor, AddQuantumColor } from \"./Square\";\n\n/**\n * Predefined variables\n * Name = Source\n * DateTime = Wed Nov 03 2021 11:14:46 GMT+0800 (中國標準時間)\n * Author = XieYe0920\n * FileBasename = Source.ts\n * FileBasenameNoExtension = Source\n * URL = db://assets/scripts/Source.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/zh/\n *\n */\n\nexport enum FanseType {Collect, Detect, Draw}\n\nexport class LightSource {\n    locate:number[];\n    dir:number;\n    color:boolean[];\n\n    constructor(locate: number[], dir: number, color:boolean[]){\n        this.locate = locate;\n        this.dir = dir;\n        this.color = color;\n    }\n}\n\nclass FanseProp {\n    over: boolean;\n    color: boolean[];\n\n    constructor() {\n        this.over = true;\n        this.color = [true, true, true];\n    }\n}\n\nexport function GetDiffDir(dir1:number, dir2:number) {\n    let diff = dir1 - dir2;\n    return diff >= 0 ? diff : (8 + diff);\n}\n\nfunction GetStep(dir:number):number[] {\n    dir = dir % 8;\n    switch(dir) {\n        case 0: return [1, 0];\n        case 1: return [1, 1];\n        case 2: return [0, 1];\n        case 3: return [-1, 1];\n        case 4: return [-1, 0];\n        case 5: return [-1, -1];\n        case 6: return [0, -1];\n        case 7: return [1, -1];\n    }\n}\n\nfunction GetFanseIndex(diff:number): number {\n    switch(diff) {\n        case 0: return 0;\n        case 2: return 3;\n        case 4: return 2;\n        case 6: return 1;\n        default: return 0;\n    }\n}\n\nexport function NewFanseArray():FanseProp[] {\n    let FS_array = new Array<FanseProp>(4);\n    for(let i=0; i<4; i++) {\n        FS_array[i] = new FanseProp();\n    }\n    return FS_array;\n}\n\nfunction QuantumNewLS(LS:LightSource, LS_array:LightSource[]) {\n    let loc = LS.locate;\n    let l_dir = LS.dir;\n    let color = LS.color\n    let id = matrix1[loc[0]*15 + loc[1]].id;\n    let m_dir = matrix1[loc[0]*15 + loc[1]].mirrordir;\n    let diff = GetDiffDir(m_dir, l_dir)\n    switch(id) {\n        case -1:\n        case 0: {\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            return LS;\n        }\n        case 1: {\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 3: {\n                    let nLS = new LightSource(loc, (l_dir + 2) % 8, color);\n                    return nLS;\n                }\n                case 4: {\n                    let nLS = new LightSource(loc, (l_dir + 4) % 8, color);\n                    return nLS;\n                }\n                case 5: {\n                    let nLS = new LightSource(loc, (l_dir + 6) % 8, color);\n                    return nLS;\n                }\n                default: return null;\n            }\n        }\n        case 2: { //斜角鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 2: {\n                    let nLS = new LightSource(loc, (l_dir + 1) % 8, color);\n                    return nLS;\n                }\n                case 3: {\n                    let nLS = new LightSource(loc, (l_dir + 3) % 8, color);\n                    return nLS;\n                }\n                case 4: {\n                    let nLS = new LightSource(loc, (l_dir + 5) % 8, color);\n                    return nLS;\n                }\n                case 5: {\n                    let nLS = new LightSource(loc, (l_dir + 7) % 8, color);\n                    return nLS;\n                }\n                default: return null;\n            }\n        }\n        case 3: //分光鏡\n        case 11: //量子鏡\n        case 12: { //反色鏡\n            let step = GetStep(l_dir);\n            let old_loc = new Array<number>(2);\n            old_loc[0] = loc[0] - step[0];\n            old_loc[1] = loc[1] - step[1];\n            let nLS = new LightSource(old_loc, l_dir, color);\n            LS_array.push(nLS);\n            return null;\n        }\n        case 4: { //濾光鏡(紅)\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                default: return null;\n            }\n        }\n        case 5: { //濾光鏡(綠)\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, l_dir, [false, true, false]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                default: return null;\n            }\n        }\n        case 6: { //濾光鏡(藍)\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, l_dir, [false, false, true]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                default: return null;\n            }\n        }\n        case 7: { //光柵\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 2:\n                case 6: {\n                    let nLS = new LightSource(loc, l_dir, color);\n                    return nLS;\n                }\n                default: return null;\n            }\n        }\n        case 8: { //三棱鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 5: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                case 1: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    else if(color[1]) {\n                        let nLS = new LightSource(loc, (l_dir + 7) % 8, [false, true, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 6) % 8, [false, false, true]);\n                        return nLS;\n                    }\n                }\n                case 4: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    else if(color[1]) {\n                        let nLS = new LightSource(loc, (l_dir + 1) % 8, [false, true, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 2) % 8, [false, false, true]);\n                        return nLS;\n                    }\n                }\n                case 6: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, (l_dir + 1) % 8, [false, true, false]);\n                        return nLS;\n                    }\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, (l_dir + 6) % 8, [false, false, true]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                case 7: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, (l_dir + 7) % 8, [false, true, false]);\n                        return nLS;\n                    }\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, (l_dir + 2) % 8, [false, false, true]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                default: return null;\n            }\n        }\n        case 9: { //變色鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 2: {\n                    let nLS = new LightSource(loc, l_dir, [color[2], color[0], color[1]]);\n                    return nLS;\n                }\n                case 6: {\n                    let nLS = new LightSource(loc, l_dir, [color[1], color[2], color[0]]);\n                    return nLS;\n                }\n                default: return null;\n            }\n        }\n        case 10: { //傳送門\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            let step = GetStep(l_dir);\n            let new_loc = new Array<number>(2);\n            [new_loc[0], new_loc[1]] = loc;\n\n            while(true) {\n                new_loc[0] = new_loc[0] + step[0];\n                new_loc[1] = new_loc[1] + step[1];\n\n                if((new_loc[0] < 0) || (new_loc[0] >= 15)) return null;\n                if((new_loc[1] < 0) || (new_loc[1] >= 15)) return null;\n\n                if(matrix1[new_loc[0]*15 + new_loc[1]].id == 10) {\n                    let nLS = new LightSource(new_loc, l_dir, color);\n                    return nLS;\n                }\n            }\n        }\n        case 13: { //順時針旋轉鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            let nLS = new LightSource(loc, (l_dir + 6) % 8, color);\n            return nLS;\n        }\n        case 14: { //逆時針旋轉鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            let nLS = new LightSource(loc, (l_dir + 2) % 8, color);\n            return nLS;\n        }\n        case 15: { //紅擇色鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 4) % 8, [false, color[1], color[2]]);\n                        return nLS;\n                    }\n                }\n                case 1:\n                case 5: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 6) % 8, [false, color[1], color[2]]);\n                        return nLS;\n                    }\n                }\n                case 3:\n                case 7: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 2) % 8, [false, color[1], color[2]]);\n                        return nLS;\n                    }\n                }\n                default: return null;\n            }\n        }\n        case 16: { //綠擇色鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, l_dir, [false, true, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 4) % 8, [color[0], false, color[2]]);\n                        return nLS;\n                    }\n                }\n                case 1:\n                case 5: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, l_dir, [false, true, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 6) % 8, [color[0], false, color[2]]);\n                        return nLS;\n                    }\n                }\n                case 3:\n                case 7: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, l_dir, [false, true, false]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 2) % 8, [color[0], false, color[2]]);\n                        return nLS;\n                    }\n                }\n                default: return null;\n            }\n        }\n        case 17: { //藍擇色鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, l_dir, [false, false, true]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 4) % 8, [color[0], color[1], false]);\n                        return nLS;\n                    }\n                }\n                case 1:\n                case 5: {\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, l_dir, [false, false, true]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 6) % 8, [color[0], color[1], false]);\n                        return nLS;\n                    }\n                }\n                case 3:\n                case 7: {\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, l_dir, [false, false, true]);\n                        return nLS;\n                    }\n                    else {\n                        let nLS = new LightSource(loc, (l_dir + 2) % 8, [color[0], color[1], false]);\n                        return nLS;\n                    }\n                }\n                default: return null;\n            }\n        }\n        case 18: { //多用濾光鏡\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let nLS = new LightSource(loc, l_dir, [false, true, false]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                case 1:\n                case 5: {\n                    if(color[2]) {\n                        let nLS = new LightSource(loc, l_dir, [false, false, true]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                case 2:\n                case 6: {\n                    let nLS = new LightSource(loc, l_dir, color);\n                    return nLS;\n                }\n                case 3:\n                case 7: {\n                    if(color[0]) {\n                        let nLS = new LightSource(loc, l_dir, [true, false, false]);\n                        return nLS;\n                    }\n                    return null;\n                }\n                default: return null;\n            }\n        }\n        case 101: { //障礙物\n            AddQuantumColor(loc, (l_dir + 4) % 8, color, true);\n            return null;\n        }\n        default: return null;\n    }\n}\n\nfunction QuantumLightTravel(LS1:LightSource, LS2:LightSource, LS_array:LightSource[]) {\n    if(LS1 == null && LS2 == null) return;\n    if(LS1 == null) {\n        let step = GetStep(LS2.dir);\n        let loc = new Array<number>(2);\n        loc[0] = LS2.locate[0] - step[0];\n        loc[1] = LS2.locate[1] - step[1];\n        let nLS = new LightSource(loc, LS2.dir, LS2.color);\n        LS_array.push(nLS);\n        return;\n    }\n    if(LS2 == null) {\n        let step = GetStep(LS1.dir);\n        let loc = new Array<number>(2);\n        loc[0] = LS1.locate[0] - step[0];\n        loc[1] = LS1.locate[1] - step[1];\n        let nLS = new LightSource(loc, LS1.dir, LS1.color);\n        LS_array.push(nLS);\n        return;\n    }\n    let nLS1 = QuantumNewLS(LS1, LS_array);\n    let nLS2 = QuantumNewLS(LS2, LS_array);\n    \n    if(nLS1) {\n        let index1 = nLS1.locate[0]*15 + nLS1.locate[1];\n        if(nLS2 && matrix1[index1].id == 9) {\n            let diff = GetDiffDir(matrix1[index1].mirrordir, nLS1.dir);\n            if(diff == 2) {\n                nLS2.color = [nLS2.color[1], nLS2.color[2], nLS2.color[0]];\n            }\n            else {\n                nLS2.color = [nLS2.color[2], nLS2.color[0], nLS2.color[1]];\n            }\n        }\n    }\n    if(nLS2) {\n        let index2 = nLS2.locate[0]*15 + nLS2.locate[1];\n        if(nLS1 && matrix1[index2].id == 9) {\n            let diff = GetDiffDir(matrix1[index2].mirrordir, nLS2.dir);\n            if(diff == 2) {\n                nLS1.color = [nLS1.color[1], nLS1.color[2], nLS1.color[0]];\n            }\n            else {\n                nLS1.color = [nLS1.color[2], nLS1.color[0], nLS1.color[1]];\n            }\n        }\n    }\n    if(nLS1) {\n        AddQuantumColor(nLS1.locate, nLS1.dir, nLS1.color, false);\n        let step1 = GetStep(nLS1.dir);\n        nLS1.locate[0] = nLS1.locate[0] + step1[0];\n        nLS1.locate[1] = nLS1.locate[1] + step1[1];\n        if(nLS1.locate[0]<0 || nLS1.locate[0]>=15 || nLS1.locate[1]<0 || nLS1.locate[1]>=15) nLS1 = null;\n    }\n    if(nLS2) {\n        AddQuantumColor(nLS2.locate, nLS2.dir, nLS2.color, false);\n        let step2 = GetStep(nLS2.dir);\n        nLS2.locate[0] = nLS2.locate[0] + step2[0];\n        nLS2.locate[1] = nLS2.locate[1] + step2[1];\n        if(nLS2.locate[0]<0 || nLS2.locate[0]>=15 || nLS2.locate[1]<0 || nLS2.locate[1]>=15) nLS2 = null;\n    }\n    QuantumLightTravel(nLS1, nLS2, LS_array);\n}\n\nexport function NewLS(id:number, locate:number[], m_dir:number, l_dir:number, color:boolean[], LS_array:LightSource[], FS_array:FanseProp[], FS_type:FanseType = FanseType.Collect) {\n    let diff = GetDiffDir(m_dir, l_dir); //注意dir_l為入射光的方向\n    switch(id) {\n        case 1: { //直角鏡\n            switch(diff) {\n                case 3: {\n                    let LS = new LightSource(locate, (l_dir + 2) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 4: {\n                    let LS = new LightSource(locate, (l_dir + 4) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 5: {\n                    let LS = new LightSource(locate, (l_dir + 6) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 2: { //斜角鏡\n            switch(diff) {\n                case 2: {\n                    let LS = new LightSource(locate, (l_dir + 1) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 3: {\n                    let LS = new LightSource(locate, (l_dir + 3) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 4: {\n                    let LS = new LightSource(locate, (l_dir + 5) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 5: {\n                    let LS = new LightSource(locate, (l_dir + 7) % 8, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 3: { //分光鏡\n            switch(diff) {\n                case 0:\n                case 4: {\n                    let LS1 = new LightSource(locate, l_dir, color);\n                    let LS2 = new LightSource(locate, (l_dir + 4) % 8, color);\n                    LS_array.push(LS1, LS2);\n                    break;\n                }\n                case 1:\n                case 5: {\n                    let LS1 = new LightSource(locate, l_dir, color);\n                    let LS2 = new LightSource(locate, (l_dir + 6) % 8, color);\n                    LS_array.push(LS1, LS2);\n                    break;\n                }\n                case 3:\n                case 7: {\n                    let LS1 = new LightSource(locate, l_dir, color);\n                    let LS2 = new LightSource(locate, (l_dir + 2) % 8, color);\n                    LS_array.push(LS1, LS2);\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 4: { //濾光鏡(紅)\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[0]) {\n                        let LS = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 5: { //濾光鏡(綠)\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let LS = new LightSource(locate, l_dir, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 6: { //濾光鏡(藍)\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[2]) {\n                        let LS = new LightSource(locate, l_dir, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 7: { //光柵\n            switch(diff) {\n                case 2:\n                case 6: {\n                    let LS = new LightSource(locate, l_dir, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 8: { //三棱鏡\n            switch(diff) {\n                case 0:\n                case 5: {\n                    if(color[0]) {\n                        let LS = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 1: {\n                    if(color[0]) {\n                        let LS = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[1]) {\n                        let LS = new LightSource(locate, (l_dir + 7) % 8, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[2]) {\n                        let LS = new LightSource(locate, (l_dir + 6) % 8, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 4: {\n                    if(color[0]) {\n                        let LS = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[1]) {\n                        let LS = new LightSource(locate, (l_dir + 1) % 8, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[2]) {\n                        let LS = new LightSource(locate, (l_dir + 2) % 8, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 6: {\n                    if(color[1]) {\n                        let LS = new LightSource(locate, (l_dir + 1) % 8, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[2]) {\n                        let LS = new LightSource(locate, (l_dir + 6) % 8, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 7: {\n                    if(color[1]) {\n                        let LS = new LightSource(locate, (l_dir + 7) % 8, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    if(color[2]) {\n                        let LS = new LightSource(locate, (l_dir + 2) % 8, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 9: { //變色鏡\n            switch(diff) {\n                case 2: {\n                    let LS = new LightSource(locate, l_dir, [color[2], color[0], color[1]]);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 6: {\n                    let LS = new LightSource(locate, l_dir, [color[1], color[2], color[0]]);\n                    LS_array.push(LS);\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 10: { //傳送門\n            let step = GetStep(l_dir);\n            let loc = new Array<number>(2);\n            [loc[0], loc[1]] = locate;\n\n            while(true) {\n                loc[0] = loc[0] + step[0];\n                loc[1] = loc[1] + step[1];\n\n                if((loc[0] < 0) || (loc[0] >= 15)) break;\n                if((loc[1] < 0) || (loc[1] >= 15)) break;\n\n                if(matrix1[loc[0]*15 + loc[1]].id == 10) {\n                    let LS = new LightSource(loc, l_dir, color);\n                    LS_array.push(LS);\n                    break;\n                }\n            }\n            break;\n        }\n        case 11: { //量子鏡\n            switch(diff) {\n                case 6: {\n                    for(let i=0; i<3; i++) {\n                        if(color[i]) {\n                            let single_color = [false, false, false];\n                            single_color[i] = true;\n                            AddQuantumColor(locate, (l_dir + 6) % 8, single_color, false);\n                            AddQuantumColor(locate, (l_dir + 2) % 8, single_color, false);\n                            let step1 = GetStep((l_dir + 6) % 8);\n                            let step2 = GetStep((l_dir + 2) % 8);\n                            let loc1 = new Array<number>(2);\n                            let loc2 = new Array<number>(2);\n                            loc1[0] = locate[0] + step1[0];\n                            loc1[1] = locate[1] + step1[1];\n                            loc2[0] = locate[0] + step2[0];\n                            loc2[1] = locate[1] + step2[1];\n                            let LS1 = new LightSource(loc1, (l_dir + 6) % 8, single_color);\n                            let LS2 = new LightSource(loc2, (l_dir + 2) % 8, single_color);\n                            if(loc1[0]<0 || loc1[0]>=15 || loc1[1]<0 || loc1[1]>=15) LS1 = null;\n                            if(loc2[0]<0 || loc2[0]>=15 || loc2[1]<0 || loc2[1]>=15) LS2 = null;\n                            QuantumLightTravel(LS1, LS2, LS_array);\n                        }\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 12: { //反色鏡\n            FS_locate[0] = locate[0];\n            FS_locate[1] = locate[1];\n            switch(diff){\n                case 0:\n                case 2:\n                case 4:\n                case 6: {\n                    if(FS_type != FanseType.Draw) {\n                        let index = GetFanseIndex(diff);\n                        let FS_color = FS_array[index].color;\n                        if((color[0] && FS_color[0]) || (color[1] && FS_color[1]) || (color[2] && FS_color[2])) {\n                            FS_array[index].color[0] &&= !color[0];\n                            FS_array[index].color[1] &&= !color[1];\n                            FS_array[index].color[2] &&= !color[2];\n                            FS_array[index].over = false;\n                        }\n                        if(!FS_array[index].color[0] && !FS_array[index].color[1] && !FS_array[index].color[2]) {\n                            FS_array[index].over = true;\n                        }\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 13: { //順時針旋轉鏡\n            let LS = new LightSource(locate, (l_dir + 6) % 8, color);\n            LS_array.push(LS);\n            break;\n        }\n        case 14: { //逆時針旋轉鏡\n            let LS = new LightSource(locate, (l_dir + 2) % 8, color);\n            LS_array.push(LS);\n            break;\n        }\n        case 15: { //紅擇色鏡\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[0]) {\n                        let LS1 = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[1] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 4) % 8, [false, color[1], color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 1:\n                case 5: {\n                    if(color[0]) {\n                        let LS1 = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[1] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 6) % 8, [false, color[1], color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 3:\n                case 7: {\n                    if(color[0]) {\n                        let LS1 = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[1] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 2) % 8, [false, color[1], color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 16: { //綠擇色鏡\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, true, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 4) % 8, [color[0], false, color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 1:\n                case 5: {\n                    if(color[1]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, true, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 6) % 8, [color[0], false, color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 3:\n                case 7: {\n                    if(color[1]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, true, false]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[2]) {\n                        let LS2 = new LightSource(locate, (l_dir + 2) % 8, [color[0], false, color[2]]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 17: { //藍擇色鏡\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[2]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, false, true]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[1]) {\n                        let LS2 = new LightSource(locate, (l_dir + 4) % 8, [color[0], color[1], false]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 1:\n                case 5: {\n                    if(color[2]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, false, true]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[1]) {\n                        let LS2 = new LightSource(locate, (l_dir + 6) % 8, [color[0], color[1], false]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                case 3:\n                case 7: {\n                    if(color[2]) {\n                        let LS1 = new LightSource(locate, l_dir, [false, false, true]);\n                        LS_array.push(LS1);\n                    }\n                    if(color[0] || color[1]) {\n                        let LS2 = new LightSource(locate, (l_dir + 2) % 8, [color[0], color[1], false]);\n                        LS_array.push(LS2);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        case 18: { //多用濾光鏡\n            switch(diff) {\n                case 0:\n                case 4: {\n                    if(color[1]) {\n                        let LS = new LightSource(locate, l_dir, [false, true, false]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 1:\n                case 5: {\n                    if(color[2]) {\n                        let LS = new LightSource(locate, l_dir, [false, false, true]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                case 2:\n                case 6: {\n                    let LS = new LightSource(locate, l_dir, color);\n                    LS_array.push(LS);\n                    break;\n                }\n                case 3:\n                case 7: {\n                    if(color[0]) {\n                        let LS = new LightSource(locate, l_dir, [true, false, false]);\n                        LS_array.push(LS);\n                    }\n                    break;\n                }\n                default: break;\n            }\n            break;\n        }\n        default: break;\n    }\n}\n\nexport function LightTravel(LS_array:LightSource[], FS_array:FanseProp[], FS_type:FanseType = FanseType.Collect) {\n    while(LS_array.length > 0) {\n        let LS = LS_array.pop();\n        if(FS_type != FanseType.Detect) AddColor(LS.locate, LS.dir, LS.color, false);\n        \n        let id:number = -1;\n        let step = GetStep(LS.dir);\n        let locate:number[] = new Array<number>(2);\n        [locate[0], locate[1]] = LS.locate;\n\n        while(true) {\n            locate[0] = locate[0] + step[0];\n            locate[1] = locate[1] + step[1];\n\n            if((locate[0] < 0) || (locate[0] >= 15)) break;\n            if((locate[1] < 0) || (locate[1] >= 15)) break;\n            \n            let [r, g, b] = GetInColor(locate, (LS.dir + 4) % 8);\n            if((!LS.color[0] || r) && (!LS.color[1] || g) && (!LS.color[2] || b)) break;\n\n            if(matrix1[locate[0]*15 + locate[1]].id > 0) {\n                id = matrix1[locate[0]*15 + locate[1]].id;\n                break;\n            }\n\n            if(FS_type != FanseType.Detect) AddColor(locate, (LS.dir + 4) % 8, LS.color, true);\n            if(FS_type != FanseType.Detect) AddColor(locate, LS.dir, LS.color, false);\n        }\n\n        if(id > 0 && id != 102) {\n            if(FS_type != FanseType.Detect) AddColor(locate, (LS.dir + 4) % 8, LS.color, true);\n            let m_dir = matrix1[locate[0]*15 + locate[1]].mirrordir;\n            NewLS(id, locate, m_dir, LS.dir, LS.color, LS_array, FS_array);\n        }\n    }\n}\n\nexport function FanseDetect(locate:number[], FS_array:FanseProp[]) {\n    while(!FS_array[0].over || !FS_array[1].over || !FS_array[2].over || !FS_array[3].over) {\n        let LS_array = new Array<LightSource>();\n        for(let i=0; i<4; i++) {\n            if(!FS_array[i].over) {\n                FS_array[i].over = true;\n                let dir = (matrix1[locate[0]*15 + locate[1]].mirrordir + 2*i) % 8;\n                let LS = new LightSource(locate, dir, FS_array[i].color);\n                LS_array.push(LS);\n            }\n        }\n        LightTravel(LS_array, FS_array, FanseType.Detect);\n    }\n}\n\nexport function FanseDraw(locate:number[], FS_array:FanseProp[]) {\n    let LS_array = new Array<LightSource>();\n    for(let i=0; i<4; i++) {\n        let color = FS_array[i].color;\n        if(!((color[0] && color[1] && color[2]) || (!color[0] && !color[1] && !color[2]))) {\n            let dir = (matrix1[locate[0]*15 + locate[1]].mirrordir + 2*i) % 8;\n            let LS = new LightSource(locate, dir, FS_array[i].color);\n            LS_array.push(LS);\n        }\n    }\n    LightTravel(LS_array, FS_array, FanseType.Draw);\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/zh/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}