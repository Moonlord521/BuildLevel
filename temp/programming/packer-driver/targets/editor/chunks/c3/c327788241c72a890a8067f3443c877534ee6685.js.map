{"version":3,"sources":["file:///D:/CocosCreator/BuildLevel/assets/scripts/LightPiece.ts"],"names":["_decorator","Component","UITransform","Sprite","SpriteFrame","resources","Color","MapInfo","GetColor","ccclass","LightPiece","dir","locate","SetProps","onLoad","UI","getComponent","anchorX","anchorY","node","setScale","setPosition","totalsize","xshift1","yshift1","setRotationFromEuler","load","_err","spriteFrame","r","g","b","sprite","color","update"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, UITransform, Sprite, SpriteFrame, resources, Color } from 'cc';\nimport { MapInfo } from './MapInfo';\nimport { GetColor } from './Square';\nconst { ccclass } = _decorator;\n\n/**\n * Predefined variables\n * Name = LightPiece\n * DateTime = Wed Nov 03 2021 20:14:34 GMT+0800 (中國標準時間)\n * Author = XieYe0920\n * FileBasename = LightPiece.ts\n * FileBasenameNoExtension = LightPiece\n * URL = db://assets/scripts/LightPiece.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/zh/\n *\n */\n\n// const ImWidth = 36;\n// const ImHeight = 2;\n// const ImData = new Uint8Array(ImWidth * ImHeight * 4);\n// for (let i=0; i<ImWidth*ImHeight*4; i++) {\n//     ImData[i] = 255;\n// }\n\n@ccclass('LightPiece')\nexport class LightPiece extends Component {\n    public dir:number = 0;\n    public locate:number[] = [0, 0];\n\n    SetProps(locate:number[], dir:number) {\n        this.locate = locate;\n        this.dir = dir;\n    }\n\n    onLoad() {\n        let UI = this.getComponent(UITransform);\n        UI.anchorX = 0;\n        UI.anchorY = 0.5;\n        \n        if(this.dir % 2 == 1) {\n            this.node.setScale(1.41421, 1);\n        }\n        else {\n            this.node.setScale(1, 1);\n        }\n\n        this.node.setPosition(this.locate[0]*MapInfo.totalsize() + MapInfo.xshift1(), this.locate[1]*MapInfo.totalsize() + MapInfo.yshift1(), 0);\n        this.node.setRotationFromEuler(0, 0, this.dir * 45);\n\n        resources.load(\"LightPiece/spriteFrame\", SpriteFrame, (_err: any, spriteFrame: SpriteFrame) => {\n            this.getComponent(Sprite).spriteFrame = spriteFrame;\n        });\n\n        let [r, g, b] = GetColor(this.locate, this.dir);\n        let sprite = this.getComponent(Sprite);\n\n        if (r == false && g == false && b == false) {\n            sprite.color = new Color(0, 0, 0, 0);\n        }\n        else {\n            sprite.color = new Color((r ? 255 : 0), (g ? 255 : 0), (b ? 255 : 0), 255);\n        }\n    }\n\n    update() {\n        let [r, g, b] = GetColor(this.locate, this.dir);\n        let sprite = this.getComponent(Sprite);\n\n        if (r == false && g == false && b == false) {\n            sprite.color = new Color(0, 0, 0, 0);\n        }\n        else {\n            sprite.color = new Color((r ? 255 : 0), (g ? 255 : 0), (b ? 255 : 0), 255);\n        }\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/zh/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}